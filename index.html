<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>抛硬币算周易</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }

        table,
        th,
        td {
            border: 1px solid black;
        }

        th,
        td {
            padding: 10px;
            text-align: center;
        }
    </style>
    <script>
        function validateAndSubmit() {
            const selects = document.querySelectorAll('select');
            let selectionMatrix = [];
            let row = [];

            for (let i = 0; i < selects.length; i++) {
                const select = selects[i];
                if (select.value === "") {
                    alert("请填入抛硬币的所有结果");
                    return;
                }

                // Map "阳" to "+" and "阴" to "-"
                row.push(select.value === "阳" ? "+" : "-");

                // After every 3 selections, push the row to the matrix and reset the row
                if ((i + 1) % 3 === 0) {
                    selectionMatrix.push(row);
                    row = [];
                }
            }

            const yinyang = {
                '+': 3,
                '-': 2
            };

            const origin = selectionMatrix.map(row =>
                row.reduce((sum, char) => sum + yinyang[char], 0)
            );

            const bengua = [];
            const biangua = [];

            for (const v of origin) {
                if (v % 2 === 1) {
                    bengua.push(true); // odd means _
                    biangua.push(v === 9 ? false : true);
                } else {
                    bengua.push(false); // even means _ _
                    biangua.push(v === 6 ? true : false);
                }
            }

            const bagua = new Map([
                [[true, true, true].toString(), "乾"],
                [[true, true, false].toString(), "兑"],
                [[true, false, true].toString(), "离"],
                [[true, false, false].toString(), "震"],
                [[false, true, true].toString(), "巽"],
                [[false, true, false].toString(), "坎"],
                [[false, false, true].toString(), "艮"],
                [[false, false, false].toString(), "坤"]
            ]);

            const benxia = bagua.get([bengua[0], bengua[1], bengua[2]].toString());
            const benshang = bagua.get([bengua[3], bengua[4], bengua[5]].toString());
            const bianxia = bagua.get([biangua[0], biangua[1], bengua[2]].toString());
            const bianshang = bagua.get([biangua[3], biangua[4], biangua[5]].toString());

            const guaxiang = new Map([
                ["乾下乾上", "乾"],//
                ["坤下坤上", "坤"],//
                ["震下坎上", "屯"],//
                ["坎下艮上", "蒙"],//
                ["乾下坎上", "需"],//
                ["坎下乾上", "讼"],//
                ["坎下坤上", "师"],//
                ["坤下坎上", "比"],//
                ["乾下巽上", "小畜"],//
                ["兑下乾上", "履"],//
                ["乾下坤上", "泰"],//
                ["坤下乾上", "否"],//
                ["离下乾上", "同人"],//
                ["乾下离上", "大有"],//
                ["艮下坤上", "谦"],//
                ["坤下震上", "豫"],//
                ["震下兑上", "随"],//
                ["巽下艮上", "蛊"],//
                ["兑下坤上", "临"],//
                ["坤下巽上", "观"],//
                ["震下离上", "噬嗑"],//
                ["离下艮上", "贲"],//
                ["坤下艮上", "剥"],//
                ["震下坤上", "复"],//
                ["震下乾上", "无妄"],//
                ["乾下艮上", "大畜"],//
                ["震下艮上", "颐"],//
                ["巽下兑上", "大过"],//
                ["坎下坎上", "坎"],//
                ["离下离上", "离"],//
                ["艮下兑上", "咸"],//
                ["巽下震上", "恒"],//
                ["艮下乾上", "遁"],//
                ["乾下震上", "大壮"],//
                ["坤下离上", "晋"],//
                ["离下坤上", "明夷"],//
                ["离下巽上", "家人"],//
                ["兑下离上", "睽"],//
                ["艮下坎上", "蹇"],//
                ["坎下震上", "解"],//
                ["兑下艮上", "损"],//
                ["震下巽上", "益"],//
                ["乾下兑上", "夬"],//
                ["巽下乾上", "姤"],//
                ["坤下兑上", "萃"],//
                ["巽下坤上", "升"],//
                ["坎下兑上", "困"],//
                ["巽下坎上", "井"],//
                ["离下兑上", "革"],//
                ["巽下离上", "鼎"],//
                ["震下震上", "震"],//
                ["艮下艮上", "艮"],//
                ["艮下巽上", "渐"],//
                ["兑下震上", "归妹"],//
                ["离下震上", "丰"],//
                ["艮下离上", "旅"],//
                ["巽下巽上", "巽"],//
                ["兑下兑上", "兑"],//
                ["坎下巽上", "涣"],//
                ["兑下坎上", "节"],//
                ["兑下巽上", "中孚"],//
                ["艮下震上", "小过"],//
                ["离下坎上", "既济"],//
                ["坎下离上", "未济"] //
            ]);

            const ben = guaxiang.get(benxia + "下" + benshang + "上");
            const bian = guaxiang.get(bianxia + "下" + bianshang + "上");


            alert("本卦: " + ben + " 变卦: " + bian);

        }


        function clearSelections() {
            const selects = document.querySelectorAll('select');
            for (let select of selects) {
                select.value = "";
            }
        }
    </script>
</head>

<body>
    <h1>抛硬币算周易</h1>
    <table>
        <tr>
            <th>抛三个相同硬币</th>
            <th>硬币 1</th>
            <th>硬币 2</th>
            <th>硬币 3</th>
        </tr>
        <tr>
            <td>第一次</td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>第二次</td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>第三次</td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>第四次</td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>第五次</td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>第六次</td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
            <td>
                <select>
                    <option value=""></option>
                    <option value="阳">阳</option>
                    <option value="阴">阴</option>
                </select>
            </td>
        </tr>
    </table>
    <br>
    <button onclick="validateAndSubmit()">开始计算</button>
    <button onclick="clearSelections()">清除结果</button>
</body>

</html>
